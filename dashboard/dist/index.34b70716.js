var e,t,n,i,r,o,s={},a=[],l=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function c(e,t){for(var n in t)e[n]=t[n];return e}function u(e){var t=e.parentNode;t&&t.removeChild(e)}function _(t,n,i){var r,o,s,a={};for(s in n)"key"==s?r=n[s]:"ref"==s?o=n[s]:a[s]=n[s];if(arguments.length>2&&(a.children=arguments.length>3?e.call(arguments,2):i),"function"==typeof t&&null!=t.defaultProps)for(s in t.defaultProps)void 0===a[s]&&(a[s]=t.defaultProps[s]);return f(t,a,r,o,null)}function f(e,i,r,o,s){var a={type:e,props:i,key:r,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==s?++n:s};return null==s&&null!=t.vnode&&t.vnode(a),a}function p(e){return e.children}function d(e,t){this.props=e,this.context=t}function h(e,t){if(null==t)return e.__?h(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?h(e):null}function m(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return m(e)}}function v(e){(!e.__d&&(e.__d=!0)&&i.push(e)&&!g.__r++||r!==t.debounceRendering)&&((r=t.debounceRendering)||setTimeout)(g)}function g(){for(var e;g.__r=i.length;)e=i.sort((function(e,t){return e.__v.__b-t.__v.__b})),i=[],e.some((function(e){var t,n,i,r,o,s;e.__d&&(o=(r=(t=e).__v).__e,(s=t.__P)&&(n=[],(i=c({},r)).__v=r.__v+1,x(s,r,i,t.__n,void 0!==s.ownerSVGElement,null!=r.__h?[o]:null,n,null==o?h(r):o,r.__h),O(n,r),r.__e!=o&&m(r)))}))}function y(e,t,n,i,r,o,l,c,u,_){var d,m,v,g,y,k,C,$=i&&i.__k||a,S=$.length;for(n.__k=[],d=0;d<t.length;d++)if(null!=(g=n.__k[d]=null==(g=t[d])||"boolean"==typeof g?null:"string"==typeof g||"number"==typeof g||"bigint"==typeof g?f(null,g,null,null,g):Array.isArray(g)?f(p,{children:g},null,null,null):g.__b>0?f(g.type,g.props,g.key,g.ref?g.ref:null,g.__v):g)){if(g.__=n,g.__b=n.__b+1,null===(v=$[d])||v&&g.key==v.key&&g.type===v.type)$[d]=void 0;else for(m=0;m<S;m++){if((v=$[m])&&g.key==v.key&&g.type===v.type){$[m]=void 0;break}v=null}x(e,g,v=v||s,r,o,l,c,u,_),y=g.__e,(m=g.ref)&&v.ref!=m&&(C||(C=[]),v.ref&&C.push(v.ref,null,g),C.push(m,g.__c||y,g)),null!=y?(null==k&&(k=y),"function"==typeof g.type&&g.__k===v.__k?g.__d=u=b(g,u,e):u=w(e,g,v,$,y,u),"function"==typeof n.type&&(n.__d=u)):u&&v.__e==u&&u.parentNode!=e&&(u=h(v))}for(n.__e=k,d=S;d--;)null!=$[d]&&j($[d],$[d]);if(C)for(d=0;d<C.length;d++)D(C[d],C[++d],C[++d])}function b(e,t,n){for(var i,r=e.__k,o=0;r&&o<r.length;o++)(i=r[o])&&(i.__=e,t="function"==typeof i.type?b(i,t,n):w(n,i,i,r,i.__e,t));return t}function k(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){k(e,t)})):t.push(e)),t}function w(e,t,n,i,r,o){var s,a,l;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==n||r!=o||null==r.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(r),s=null;else{for(a=o,l=0;(a=a.nextSibling)&&l<i.length;l+=2)if(a==r)break e;e.insertBefore(r,o),s=o}return void 0!==s?s:r.nextSibling}function C(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||l.test(t)?n:n+"px"}function $(e,t,n,i,r){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||C(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||C(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?i||e.addEventListener(t,o?T:S,o):e.removeEventListener(t,o?T:S,o);else if("dangerouslySetInnerHTML"!==t){if(r)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&-1==t.indexOf("-")?e.removeAttribute(t):e.setAttribute(t,n))}}function S(e){this.l[e.type+!1](t.event?t.event(e):e)}function T(e){this.l[e.type+!0](t.event?t.event(e):e)}function x(n,i,r,o,a,l,_,f,m){var v,g,b,k,w,C,S,T,x,O,D,j,R,A,F,P=i.type;if(void 0!==i.constructor)return null;null!=r.__h&&(m=r.__h,f=i.__e=r.__e,i.__h=null,l=[f]),(v=t.__b)&&v(i);try{e:if("function"==typeof P){if(T=i.props,x=(v=P.contextType)&&o[v.__c],O=v?x?x.props.value:v.__:o,r.__c?S=(g=i.__c=r.__c).__=g.__E:("prototype"in P&&P.prototype.render?i.__c=g=new P(T,O):(i.__c=g=new d(T,O),g.constructor=P,g.render=U),x&&x.sub(g),g.props=T,g.state||(g.state={}),g.context=O,g.__n=o,b=g.__d=!0,g.__h=[],g._sb=[]),null==g.__s&&(g.__s=g.state),null!=P.getDerivedStateFromProps&&(g.__s==g.state&&(g.__s=c({},g.__s)),c(g.__s,P.getDerivedStateFromProps(T,g.__s))),k=g.props,w=g.state,b)null==P.getDerivedStateFromProps&&null!=g.componentWillMount&&g.componentWillMount(),null!=g.componentDidMount&&g.__h.push(g.componentDidMount);else{if(null==P.getDerivedStateFromProps&&T!==k&&null!=g.componentWillReceiveProps&&g.componentWillReceiveProps(T,O),!g.__e&&null!=g.shouldComponentUpdate&&!1===g.shouldComponentUpdate(T,g.__s,O)||i.__v===r.__v){for(g.props=T,g.state=g.__s,i.__v!==r.__v&&(g.__d=!1),g.__v=i,i.__e=r.__e,i.__k=r.__k,i.__k.forEach((function(e){e&&(e.__=i)})),D=0;D<g._sb.length;D++)g.__h.push(g._sb[D]);g._sb=[],g.__h.length&&_.push(g);break e}null!=g.componentWillUpdate&&g.componentWillUpdate(T,g.__s,O),null!=g.componentDidUpdate&&g.__h.push((function(){g.componentDidUpdate(k,w,C)}))}if(g.context=O,g.props=T,g.__v=i,g.__P=n,j=t.__r,R=0,"prototype"in P&&P.prototype.render){for(g.state=g.__s,g.__d=!1,j&&j(i),v=g.render(g.props,g.state,g.context),A=0;A<g._sb.length;A++)g.__h.push(g._sb[A]);g._sb=[]}else do{g.__d=!1,j&&j(i),v=g.render(g.props,g.state,g.context),g.state=g.__s}while(g.__d&&++R<25);g.state=g.__s,null!=g.getChildContext&&(o=c(c({},o),g.getChildContext())),b||null==g.getSnapshotBeforeUpdate||(C=g.getSnapshotBeforeUpdate(k,w)),F=null!=v&&v.type===p&&null==v.key?v.props.children:v,y(n,Array.isArray(F)?F:[F],i,r,o,a,l,_,f,m),g.base=i.__e,i.__h=null,g.__h.length&&_.push(g),S&&(g.__E=g.__=null),g.__e=!1}else null==l&&i.__v===r.__v?(i.__k=r.__k,i.__e=r.__e):i.__e=function(t,n,i,r,o,a,l,c){var _,f,p,d=i.props,m=n.props,v=n.type,g=0;if("svg"===v&&(o=!0),null!=a)for(;g<a.length;g++)if((_=a[g])&&"setAttribute"in _==!!v&&(v?_.localName===v:3===_.nodeType)){t=_,a[g]=null;break}if(null==t){if(null===v)return document.createTextNode(m);t=o?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,m.is&&m),a=null,c=!1}if(null===v)d===m||c&&t.data===m||(t.data=m);else{if(a=a&&e.call(t.childNodes),f=(d=i.props||s).dangerouslySetInnerHTML,p=m.dangerouslySetInnerHTML,!c){if(null!=a)for(d={},g=0;g<t.attributes.length;g++)d[t.attributes[g].name]=t.attributes[g].value;(p||f)&&(p&&(f&&p.__html==f.__html||p.__html===t.innerHTML)||(t.innerHTML=p&&p.__html||""))}if(function(e,t,n,i,r){var o;for(o in n)"children"===o||"key"===o||o in t||$(e,o,null,n[o],i);for(o in t)r&&"function"!=typeof t[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===t[o]||$(e,o,t[o],n[o],i)}(t,m,d,o,c),p)n.__k=[];else if(g=n.props.children,y(t,Array.isArray(g)?g:[g],n,i,r,o&&"foreignObject"!==v,a,l,a?a[0]:i.__k&&h(i,0),c),null!=a)for(g=a.length;g--;)null!=a[g]&&u(a[g]);c||("value"in m&&void 0!==(g=m.value)&&(g!==t.value||"progress"===v&&!g||"option"===v&&g!==d.value)&&$(t,"value",g,d.value,!1),"checked"in m&&void 0!==(g=m.checked)&&g!==t.checked&&$(t,"checked",g,d.checked,!1))}return t}(r.__e,i,r,o,a,l,_,m);(v=t.diffed)&&v(i)}catch(e){i.__v=null,(m||null!=l)&&(i.__e=f,i.__h=!!m,l[l.indexOf(f)]=null),t.__e(e,i,r)}}function O(e,n){t.__c&&t.__c(n,e),e.some((function(n){try{e=n.__h,n.__h=[],e.some((function(e){e.call(n)}))}catch(e){t.__e(e,n.__v)}}))}function D(e,n,i){try{"function"==typeof e?e(n):e.current=n}catch(e){t.__e(e,i)}}function j(e,n,i){var r,o;if(t.unmount&&t.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||D(r,null,n)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){t.__e(e,n)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&j(r[o],n,i||"function"!=typeof e.type);i||null==e.__e||u(e.__e),e.__=e.__e=e.__d=void 0}function U(e,t,n){return this.constructor(e,n)}function R(n,i,r){var o,a,l;t.__&&t.__(n,i),a=(o="function"==typeof r)?null:r&&r.__k||i.__k,l=[],x(i,n=(!o&&r||i).__k=_(p,null,[n]),a||s,s,void 0!==i.ownerSVGElement,!o&&r?[r]:a?null:i.firstChild?e.call(i.childNodes):null,l,!o&&r?r:a?a.__e:i.firstChild,o),O(l,n)}function A(t,n,i){var r,o,s,a=c({},t.props);for(s in n)"key"==s?r=n[s]:"ref"==s?o=n[s]:a[s]=n[s];return arguments.length>2&&(a.children=arguments.length>3?e.call(arguments,2):i),f(t.type,a,r||t.key,o||t.ref,null)}e=a.slice,t={__e:function(e,t,n,i){for(var r,o,s;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&null!=o.getDerivedStateFromError&&(r.setState(o.getDerivedStateFromError(e)),s=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e,i||{}),s=r.__d),s)return r.__E=r}catch(t){e=t}throw e}},n=0,d.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=c({},this.state),"function"==typeof e&&(e=e(c({},n),this.props)),e&&c(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),v(this))},d.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),v(this))},d.prototype.render=p,i=[],g.__r=0,o=0;var F=function(e,t,n,i){var r;t[0]=0;for(var o=1;o<t.length;o++){var s=t[o++],a=t[o]?(t[0]|=s?1:2,n[t[o++]]):t[++o];3===s?i[0]=a:4===s?i[1]=Object.assign(i[1]||{},a):5===s?(i[1]=i[1]||{})[t[++o]]=a:6===s?i[1][t[++o]]+=a+"":s?(r=e.apply(a,F(e,a,n,["",null])),i.push(r),a[0]?t[0]|=2:(t[o-2]=0,t[o]=r)):i.push(a)}return i},P=new Map;var I,E,M,N=[],H=[],L=t.__b,W=t.__r,B=t.diffed,V=t.__c,q=t.unmount;function K(){for(var e;e=N.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(G),e.__H.__h.forEach(Q),e.__H.__h=[]}catch(n){e.__H.__h=[],t.__e(n,e.__v)}}t.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),I=null,L&&L(e)},t.__r=function(e){W&&W(e),0;var t=(I=e.__c).__H;t&&(E===I?(t.__h=[],I.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=H,e.__N=e.i=void 0}))):(t.__h.forEach(G),t.__h.forEach(Q),t.__h=[])),E=I},t.diffed=function(e){B&&B(e);var n=e.__c;n&&n.__H&&(n.__H.__h.length&&(1!==N.push(n)&&M===t.requestAnimationFrame||((M=t.requestAnimationFrame)||J)(K)),n.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==H&&(e.__=e.__V),e.i=void 0,e.__V=H}))),E=I=null},t.__c=function(e,n){n.some((function(e){try{e.__h.forEach(G),e.__h=e.__h.filter((function(e){return!e.__||Q(e)}))}catch(i){n.some((function(e){e.__h&&(e.__h=[])})),n=[],t.__e(i,e.__v)}})),V&&V(e,n)},t.unmount=function(e){q&&q(e);var n,i=e.__c;i&&i.__H&&(i.__H.__.forEach((function(e){try{G(e)}catch(e){n=e}})),i.__H=void 0,n&&t.__e(n,i.__v))};var z="function"==typeof requestAnimationFrame;function J(e){var t,n=function(){clearTimeout(i),z&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,100);z&&(t=requestAnimationFrame(n))}function G(e){var t=I,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),I=t}function Q(e){var t=I;e.__c=e.__(),I=t}var X={};function Y(e,t){for(var n in t)e[n]=t[n];return e}function Z(e,t,n){var i,r=/(?:\?([^#]*))?(#.*)?$/,o=e.match(r),s={};if(o&&o[1])for(var a=o[1].split("&"),l=0;l<a.length;l++){var c=a[l].split("=");s[decodeURIComponent(c[0])]=decodeURIComponent(c.slice(1).join("="))}e=ne(e.replace(r,"")),t=ne(t||"");for(var u=Math.max(e.length,t.length),_=0;_<u;_++)if(t[_]&&":"===t[_].charAt(0)){var f=t[_].replace(/(^:|[+*?]+$)/g,""),p=(t[_].match(/[+*?]+$/)||X)[0]||"",d=~p.indexOf("+"),h=~p.indexOf("*"),m=e[_]||"";if(!m&&!h&&(p.indexOf("?")<0||d)){i=!1;break}if(s[f]=decodeURIComponent(m),d||h){s[f]=e.slice(_).map(decodeURIComponent).join("/");break}}else if(t[_]!==e[_]){i=!1;break}return(!0===n.default||!1!==i)&&s}function ee(e,t){return e.rank<t.rank?1:e.rank>t.rank?-1:e.index-t.index}function te(e,t){return e.index=t,e.rank=function(e){return e.props.default?0:ne(e.props.path).map(ie).join("")}(e),e.props}function ne(e){return e.replace(/(^\/+|\/+$)/g,"").split("/")}function ie(e){return":"==e.charAt(0)?1+"*+?".indexOf(e.charAt(e.length-1))||4:5}var re,oe,se={},ae=[],le=[],ce=null,ue={url:fe()},_e=(oe={__c:re="__cC"+o++,__:ue,Consumer:function(e,t){return e.children(t)},Provider:function(e){var t,n;return this.getChildContext||(t=[],(n={})[re]=this,this.getChildContext=function(){return n},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&t.some(v)},this.sub=function(e){t.push(e);var n=e.componentWillUnmount;e.componentWillUnmount=function(){t.splice(t.indexOf(e),1),n&&n.call(e)}}),e.children}}).Provider.__=oe.Consumer.contextType=oe;function fe(){var e;return""+((e=ce&&ce.location?ce.location:ce&&ce.getCurrentLocation?ce.getCurrentLocation():"undefined"!=typeof location?location:se).pathname||"")+(e.search||"")}function pe(e,t){return void 0===t&&(t=!1),"string"!=typeof e&&e.url&&(t=e.replace,e=e.url),function(e){for(var t=ae.length;t--;)if(ae[t].canRoute(e))return!0;return!1}(e)&&function(e,t){void 0===t&&(t="push"),ce&&ce[t]?ce[t](e):"undefined"!=typeof history&&history[t+"State"]&&history[t+"State"](null,null,e)}(e,t?"replace":"push"),de(e)}function de(e){for(var t=!1,n=0;n<ae.length;n++)ae[n].routeTo(e)&&(t=!0);return t}function he(e){if(e&&e.getAttribute){var t=e.getAttribute("href"),n=e.getAttribute("target");if(t&&t.match(/^\//g)&&(!n||n.match(/^_?self$/i)))return pe(t)}}function me(e){return e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault(),!1}function ve(e){if(!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button)){var t=e.target;do{if("a"===t.localName&&t.getAttribute("href")){if(t.hasAttribute("data-native")||t.hasAttribute("native"))return;if(he(t))return me(e)}}while(t=t.parentNode)}}var ge=!1;function ye(e){e.history&&(ce=e.history),this.state={url:e.url||fe()}}Y(ye.prototype=new d,{shouldComponentUpdate:function(e){return!0!==e.static||e.url!==this.props.url||e.onChange!==this.props.onChange},canRoute:function(e){var t=k(this.props.children);return void 0!==this.g(t,e)},routeTo:function(e){this.setState({url:e});var t=this.canRoute(e);return this.p||this.forceUpdate(),t},componentWillMount:function(){this.p=!0},componentDidMount:function(){var e=this;ge||(ge=!0,ce||addEventListener("popstate",(function(){de(fe())})),addEventListener("click",ve)),ae.push(this),ce&&(this.u=ce.listen((function(t){var n=t.location||t;e.routeTo(""+(n.pathname||"")+(n.search||""))}))),this.p=!1},componentWillUnmount:function(){"function"==typeof this.u&&this.u(),ae.splice(ae.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(e,t){e=e.filter(te).sort(ee);for(var n=0;n<e.length;n++){var i=e[n],r=Z(t,i.props.path,i.props);if(r)return[i,r]}},render:function(e,t){var n,i,r=e.onChange,o=t.url,s=this.c,a=this.g(k(e.children),o);if(a&&(i=A(a[0],Y(Y({url:o,matches:n=a[1]},n),{key:void 0,ref:void 0}))),o!==(s&&s.url)){Y(ue,s=this.c={url:o,previous:s&&s.url,current:i,path:i?i.props.path:null,matches:n}),s.router=this,s.active=i?[i]:[];for(var l=le.length;l--;)le[l]({});"function"==typeof r&&r(s)}return _(_e.Provider,{value:s},i)}});function be({updateTimeframe:e,updateCustomTimeframe:t,clearCustomTimeframe:n,updateResolution:i,filters:r}){return _("div",{class:"grid-lg contain"},[!r.from&&!r.to&&_("div",{class:"w-50-lg"},[_("h4",{},"Timeframe"),_("div",{},[o("today","Today"),o("past-day","Past day"),o("past-week","Past week")]),_("div",{},[o("past-month","Past month"),o("past-6-months","Past 6 months"),o("past-year","Past year")])]),!r.from&&!r.to&&_("div",{class:"w-50-lg"},[_("h4",{},"Resolution"),_("div",{},[["past-year","past-6-months"].includes(r.timeframe)&&s("monthly","Monthly"),["past-week","past-month","past-6-months","past-year"].includes(r.timeframe)&&s("daily","Daily"),["today","past-day","past-week","past-month"].includes(r.timeframe)&&s("hourly","Hourly"),["today","past-day","past-week"].includes(r.timeframe)&&s("minutes","Minutes")].filter(Boolean))]),(r.from||r.to)&&_("div",{class:"w-50-lg"},[_("h4",{},"Resolution"),_("div",{},[s("daily","Daily"),s("hourly","Hourly")])]),r.from&&_("div",{},[r.from&&_("span",{class:"filterable static-filter"},"From "),r.from&&_("input",{type:"datetime-local",onChange:e=>{t(+new Date(e.target.value),+r.to)},value:new Date(+r.from).toISOString().substring(0,16)})]),r.from&&r.to&&_("div",{},[r.to&&_("span",{class:"filterable static-filter"},"To "),r.to&&_("input",{type:"datetime-local",onChange:e=>{t(+r.from,+new Date(e.target.value))},value:new Date(+r.to).toISOString().substring(0,16)})]),(r.from||r.to)&&_("div",{class:"filterable static-filter",onClick:()=>n()},["Clear [x]"])].filter(Boolean));function o(t,n){return _("a",{href:"#",onClick:n=>{n.preventDefault(),e(t)},class:`select-timeframe filterable static-filter ${r.timeframe===t&&"active"}`,name:t,id:t},n)}function s(e,t){return _("a",{href:"#",onClick:t=>{t.preventDefault(),i(e)},class:`select-resolution filterable static-filter ${r.resolution===e&&"active"}`,name:e,id:e},t)}}function ke({theme:e,toggleTheme:t=Function.prototype}){return _("div",{class:"theme-toggle",onClick:t},[("dark"===e?"light":"dark")+" theme"])}function we({data:e,filters:t={},updateCustomTimeframe:n}){if(!e)return null;if(!Array.isArray(e.chartData))return null;if(e.chartData.length<2)return _("div",{id:"pageviews-chart",style:{"text-align":"center"}},["Insufficient data to show chart..",_("br",{},[]),"Try to change timeframe or resolution."]);const i=Math.max(...e.chartData.map((e=>e[1])));return _("div",{id:"pageviews-chart"},[_("table",{class:"charts-css column show-labels show-primary-axis"},[_("thead",{},[_("tr",{},[_("th",{scope:"col"},"Date"),_("th",{scope:"col"},"Pageviews")])]),_("tbody",{},e.chartData.map(((o,s)=>_("tr",{key:o[0],onClick:()=>n(+new Date(o[0]))},[_("td",{style:{"--start":0===s?0:e.chartData[s-1][1]/i,"--size":o[1]/i}},[e.chartData.length<50&&_("span",{class:"data"},o[1]),_("span",{class:"tooltip"},[r(o[0],t.resolution),_("br",{},null),`${o[1]} pageviews`])].filter(Boolean))]))))])]);function r(e,t){return"daily"===t||"monthly"===t?new Date(e).toLocaleDateString():new Date(e).toLocaleString()}}function Ce({data:e,filters:t={},toggleFilter:n}){if(!e)return null;if(!Number.isFinite(e.visitorsCount))return null;if(!Number.isFinite(e.pageviewsCount))return null;let i=e.live||{};return Object.keys(t).length>2&&(i=Object.keys(i).reduce(((e,n)=>Object.keys(t).filter((e=>["p","r","v"].includes(e))).every((e=>i[n].pageview[e]===t[e]))?Object.assign(e,{[n]:i[n]}):e),{})),_("div",{},[_("div",{class:"grid contain text-lg"},[_("div",{class:"w-50"},[_("h2",{},"Visitors"),_("div",{id:"visitors-count"},e.visitorsCount)]),_("div",{class:"w-50"},[_("h2",{},"Pageviews"),_("div",{id:"pageviews-count"},e.pageviewsCount)]),_("div",{class:"w-50"},[_("h2",{},"Bounce rate"),_("div",{id:"bounce-rate"},(e.visitorsCount/e.pageviewsCount*100).toFixed(0)+"%")]),_("div",{class:"w-50"},[_("h2",{},"Live"),_("div",{id:"live"},Object.keys(i).length)])]),_("div",{class:"contain",id:"live-pages"},[Object.keys(i).length>0&&_("h2",{},["Live pages ",_("span",{class:"live-dot"},[])]),_("ul",{},Object.keys(i).reduce(((e,t)=>{const n=e.find((({p:e})=>e===i[t].pageview.p));return n?(n.c++,e):e.concat([{p:i[t].pageview.p,c:1}])}),[]).sort(((e,t)=>e.c-t.c)).map((({p:e,c:i})=>_("li",{class:`filterable ${t.p===e&&"active"}`,onClick:()=>n("p",e),key:e},`${i} · ${e}`))))].filter(Boolean)),_("div",{class:"contain",id:"live-referrers"},[Object.keys(i).length>0&&_("h2",{},["Live referrers ",_("span",{class:"live-dot"},[])]),_("ul",{},Object.keys(i).reduce(((e,t)=>{const n=e.find((({r:e})=>e===i[t].pageview.r));return n?(n.c++,e):e.concat([{r:i[t].pageview.r,c:1}])}),[]).sort(((e,t)=>e.c-t.c)).map((({r:e,c:i})=>_("li",{class:`filterable ${t.r===e&&"active"}`,onClick:()=>n("r",e),key:e},`${i} · ${(e||"").replace("https://","").replace("http://","")||"none"}`))))].filter(Boolean))].filter(Boolean))}function $e(e){if(!e)return"/";const t=document.createElement("a");return t.href=e,t.hostname}function Se({data:e,loading:t,filters:n={},toggleFilter:i}){if(!e)return null;const{referrers:r=[]}=e,{pages:o=[]}=e,s=Math.max(...r.map((e=>e.views))),a=Math.max(...o.map((e=>e.views)));return _("div",{},[_("div",{class:`grid-lg contain ${t&&"loading"}`},[_("div",{class:"w-50-lg",id:"referrers"},[_("h2",{},"Top Referrers"),_("ul",{id:"top-referrers"},r.map((e=>{const t=`https://icons.duckduckgo.com/ip3/${$e(e.r)}.ico`;return _("li",{key:e.r,class:`filterable ${n.r===e.r&&"active"}`,style:{"--data-percentage":100-80*e.views/s+"%"},onClick:()=>i("r",e.r)},[_("div",{},[_("b",{class:"views"},e.views),_("img",{loading:"lazy",class:"favicon",src:t},[]),e.r.replace("https://","").replace("http://","")||"none"])])})))]),_("div",{class:"w-50-lg",id:"pages"},[_("h2",{},"Top Pages"),_("ul",{id:"top-pages"},o.map((e=>_("li",{key:e.p,onClick:()=>i("p",e.p),class:`filterable ${n.p===e.p&&"active"}`,style:{"--data-percentage":100-80*e.views/a+"%"}},[_("b",{class:"views"},e.views),e.p]))))])])])}function Te({data:e,filters:t={},toggleFilter:n}){return e&&Array.isArray(e.data)?_("div",{class:"contain"},[_("ul",{},e.data.map(((e,i)=>{return _("li",{class:"pageview",key:e.d},[_("div",{class:`filterable ${t.v===e.v&&"active"}`,onClick:()=>n("v",e.v)},[_("time",{},e.d.substring(0,19)),e.v," ",_("span",{style:{"background-color":(r=e.v,"#"+function(e){const t=(16777215&e).toString(16).toUpperCase();return"00000".substring(0,6-t.length)+t}(function(e){let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t}(r)))},class:"visitor dot"},[])]),_("div",{class:`filterable ${t.p===e.p&&"active"}`,onClick:()=>n("p",e.p)},[_("b",{},e.p)]),e.r&&_("div",{class:`filterable ${t.r===e.r&&"active"}`,onClick:()=>n("r",e.r)},["from ",_("img",{class:"favicon",src:`https://icons.duckduckgo.com/ip3/${$e(e.r)}.ico`}),e.r.replace("https://","").replace("http://","")])].filter(Boolean));var r})))]):null}function xe({data:e,filters:t,loading:n}){return _("div",{class:"grid contain text-lg"},[_("details",{class:`${n&&"loading"}`,open:!0},[_("summary",{class:"",id:"report"},[_("span",{},"Textual report")]),_("h1",{class:""},`Stats for timeframe: ${t.timeframe||`${t.from&&new Date(+t.from).toISOString()} - ${t.to&&new Date(+t.to).toISOString()||"now"}`}`),_("h2",{class:""},`${e.visitorsCount} visitors and ${e.pageviewsCount} pageviews`),_("h2",{class:""},`Resulting in a ${(e.visitorsCount/e.pageviewsCount*100).toFixed(0)+"%"} bounce rate`),_("h2",{class:""},`Most traffic came from ${$e(e.referrers[0].r)} (${e.referrers[0].views}, ~${Math.floor(e.referrers[0].views/e.pageviewsCount*100)}%)`),_("h2",{class:""},"The three most visited pages are"),_("ul",{class:""},[e.pages[0]&&_("li",{class:""},`${e.pages[0].views} - ${e.pages[0].p}`),e.pages[1]&&_("li",{class:""},`${e.pages[1].views} - ${e.pages[1].p}`),e.pages[2]&&_("li",{class:""},`${e.pages[2].views} - ${e.pages[2].p}`)])])])}class Oe extends d{render({data:e,filters:t,loading:n,theme:i,report:r,updateResolution:o,updateTimeframe:s,updateCustomTimeframe:a,clearCustomTimeframe:l,toggleFilter:c,toggleTheme:u}={}){return 0===Object.keys(e).length?null:_("div",{class:`${n&&"loading"}`},[_(ke,{theme:i,toggleTheme:u},[]),_(be,{filters:t,clearCustomTimeframe:l,updateResolution:o,updateTimeframe:s,updateCustomTimeframe:a},[]),_(we,{data:e,filters:t,updateCustomTimeframe:a},[]),_(Ce,{data:e,filters:t,toggleFilter:c},[]),_(xe,{data:e,report:r,filters:t},[]),_(Se,{data:e,filters:t,toggleFilter:c},[]),_(Te,{data:e,filters:t,toggleFilter:c},[])].filter(Boolean))}}const De={data:{},mounted:!1,loading:!1,filters:{timeframe:"today",resolution:"hourly"},theme:"light",report:{}};localStorage.getItem("state")&&Object.assign(De,JSON.parse(localStorage.getItem("state")));const je=function(e){var t=P.get(this);return t||(t=new Map,P.set(this,t)),(t=F(this,t.get(e)||(t.set(e,t=function(e){for(var t,n,i=1,r="",o="",s=[0],a=function(e){1===i&&(e||(r=r.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?s.push(0,e,r):3===i&&(e||r)?(s.push(3,e,r),i=2):2===i&&"..."===r&&e?s.push(4,e,0):2===i&&r&&!e?s.push(5,0,!0,r):i>=5&&((r||!e&&5===i)&&(s.push(i,0,r,n),i=6),e&&(s.push(i,e,0,n),i=6)),r=""},l=0;l<e.length;l++){l&&(1===i&&a(),a(l));for(var c=0;c<e[l].length;c++)t=e[l][c],1===i?"<"===t?(a(),s=[s],i=3):r+=t:4===i?"--"===r&&">"===t?(i=1,r=""):r=t+r[0]:o?t===o?o="":r+=t:'"'===t||"'"===t?o=t:">"===t?(a(),i=1):i&&("="===t?(i=5,n=r,r=""):"/"===t&&(i<5||">"===e[l][c+1])?(a(),3===i&&(s=s[0]),i=s,(s=s[0]).push(2,0,i),i=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(a(),i=2):r+=t),3===i&&"!--"===r&&(i=4,s=s[0])}return a(),s}(e)),t),arguments,[])).length>1?t:t[0]}.bind(_);R(je`<${class extends d{state=De;componentDidMount(){if(window.location.search){const e=window.location.search.substring(1).split("&").map((e=>e.split("="))).reduce(((e,t)=>Object.assign(e,{[t[0]]:decodeURIComponent(t[1])})),{});this.setState({mounted:!0,filters:Object.assign({},this.state.filters,e)},(()=>this.getData()))}else this.setState({mounted:!0},(()=>this.getData()));setInterval((()=>this.getData()),6e4);new window.EventSource("/").onmessage=e=>{if(!e||!e.data)return console.error("skipping empty message");try{const t=JSON.parse(e.data,{});this.setState({data:Object.assign({},this.state.data,{live:t})})}catch(e){console.error("sse parse error",e)}}}async handleRoute(e){if(this.state.mounted)if(window.location.search){const e=window.location.search.substring(1).split("&").map((e=>e.split("="))).reduce(((e,t)=>Object.assign(e,{[t[0]]:decodeURIComponent(t[1])})),{});this.setState({filters:Object.assign({},this.state.filters,e)},(()=>this.getData()))}else this.getData()}async getData(){if(this.state.loading)return;this.setState({loading:!0});let e="";Object.keys(this.state.filters).length>0&&(e="?"+Object.keys(this.state.filters).reduce(((e,t)=>e.concat([`${t}=${encodeURIComponent(this.state.filters[t])}`])),[]).join("&"));const t=/(localhost|127\.0\.0\.1|0\.0\.0\.0)/.test(window.location.origin)?"http://127.0.0.1:8080":window.location.origin,n=await window.fetch(t+"/api/"+e),i=await n.json();this.setState({data:i,loading:!1},(()=>localStorage.setItem("state",JSON.stringify(this.state))))}clearCustomTimeframe(){const e=Object.assign({},this.state.filters,{timeframe:"past-day"});delete e.from,delete e.to,this.setState({filters:e},(()=>pe("?"+Object.keys(e).reduce(((t,n)=>t.concat([`${n}=${encodeURIComponent(e[n])}`])),[]).join("&"))))}updateCustomTimeframe(e,t=Date.now()){if(!Number.isFinite(+new Date(e)))return;if(!Number.isFinite(+new Date(t)))return;const n=Object.assign({},this.state.filters,{from:e,to:t});delete n.timeframe,this.setState({filters:n},(()=>pe("?"+Object.keys(n).reduce(((e,t)=>e.concat([`${t}=${encodeURIComponent(n[t])}`])),[]).join("&"))))}updateTimeframe(e){const t=Object.assign({},this.state.filters,{timeframe:e});["today","past-day"].includes(e)&&["monthly","daily"].includes(t.resolution)&&(t.resolution="hourly"),["past-week"].includes(e)&&["minutes","monthly"].includes(t.resolution)&&(t.resolution="daily"),["past-month"].includes(e)&&["monthly"].includes(t.resolution)&&(t.resolution="daily"),["past-6-months"].includes(e)&&["minutes","hourly"].includes(t.resolution)&&(t.resolution="daily"),["past-year"].includes(e)&&["minutes","hourly"].includes(t.resolution)&&(t.resolution="monthly"),this.setState({filters:t},(()=>pe("?"+Object.keys(t).reduce(((e,n)=>e.concat([`${n}=${encodeURIComponent(t[n])}`])),[]).join("&"))))}updateResolution(e){const t=Object.assign({},this.state.filters,{resolution:e});this.setState({filters:t},(()=>pe("?"+Object.keys(t).reduce(((e,n)=>e.concat([`${n}=${encodeURIComponent(t[n])}`])),[]).join("&"))))}toggleFilter(e,t){const n=Object.assign({},this.state.filters);n[e]===t?delete n[e]:n[e]=t,this.setState({filters:n},(()=>pe("?"+Object.keys(n).reduce(((e,t)=>e.concat([`${t}=${encodeURIComponent(n[t])}`])),[]).join("&"))))}toggleTheme(){this.setState({theme:"dark"===this.state.theme?"light":"dark"})}render(){return _("div",{id:"app",class:`theme-${this.state.theme}`},[_(ye,{onChange:this.handleRoute.bind(this)},[_(Oe,{data:this.state.data,filters:this.state.filters,loading:this.state.loading,theme:this.state.theme,updateResolution:this.updateResolution.bind(this),updateTimeframe:this.updateTimeframe.bind(this),updateCustomTimeframe:this.updateCustomTimeframe.bind(this),clearCustomTimeframe:this.clearCustomTimeframe.bind(this),toggleFilter:this.toggleFilter.bind(this),toggleTheme:this.toggleTheme.bind(this),path:"/"},[])])])}}}/>`,document.body);
//# sourceMappingURL=index.34b70716.js.map
